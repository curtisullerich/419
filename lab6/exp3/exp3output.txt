----------------------
-----Experiment 3-----
----------------------

----------------------
--------Part A--------
----------------------
hive> use curtis;
hive> CREATE EXTERNAL TABLE curtis.rawblock (id string, status string) 
    > ROW FORMAT DELIMITED FIELDS TERMINATED BY ' ' 
    > LOCATION '/users/curtisu/Lab6/Exp3/raw_block';
OK
Time taken: 0.057 seconds

hive> CREATE EXTERNAL TABLE curtis.iptrace  (time string, id string, src string, bracket string, dest string, protocol string, port string) 
    > ROW FORMAT DELIMITED FIELDS TERMINATED BY ' ' 
    > LOCATION '/users/curtisu/Lab6/Exp3/ip_trace';
OK
Time taken: 0.102 seconds

----------------------
--------Part B--------
----------------------
hive> select src, count(1) as c 
    > from (select * from rawblock join iptrace on (rawblock.id = iptrace.id and rawblock.status = 'Blocked')) blocks
    > group by src sort by c desc;

92.242.214.87 95798
5.63.211.111  95773
16.249.174.65 95680
169.33.166.84 95644
183.75.70.167 95643
69.252.133.169  95579
11.9.136.96 95518
146.8.134.4 95474
8.187.238.228 95468
243.85.7.254  95441
189.170.237.171 95430
107.166.70.218  95427
180.238.59.205  95426
87.60.225.250 95401
76.150.20.124 95392
249.194.73.211  95391
38.147.184.98 95365
103.92.254.253  95330
77.244.203.129  95311
183.108.45.52 95297
249.248.175.252 95287
220.10.95.90  95275
2.48.124.145  95252
1.91.101.227  95242
52.79.15.213  95238
22.94.208.178 95230
232.110.205.3 95227
1.99.32.219 95218
63.64.10.42 95216
66.37.247.98  95213
220.241.48.29 95212
118.195.1.133 95207
0.163.13.118  95202
116.70.232.169  95191
27.80.98.145  95188
98.173.232.103  95185
250.100.127.155 95173
219.231.199.75  95166
157.250.241.178 95163
233.165.242.188 95155
4.75.63.79  95151
69.67.228.96  95135
134.115.61.7  95126
159.122.242.100 95118
111.142.41.52 95099
108.199.155.221 95099
29.16.211.6 95097
184.78.32.106 95093
66.63.222.74  95074
74.117.212.240  95067
144.78.178.130  95067
20.107.88.63  95065
85.27.131.188 95065
60.240.78.53  95051
187.133.1.239 95046
246.173.211.132 95022
169.166.247.162 95015
129.229.31.221  95000
90.198.196.72 94993
178.140.202.139 94990
230.121.40.178  94976
109.166.123.103 94975
229.108.240.69  94963
151.102.83.132  94950
176.74.57.196 94942
92.62.89.80 94939
199.9.224.5 94930
249.145.109.133 94930
139.74.71.121 94930
52.182.253.141  94925
28.227.207.155  94921
193.117.165.210 94915
15.191.47.54  94911
207.101.66.249  94908
179.229.116.24  94908
161.184.206.185 94894
38.115.94.91  94884
244.134.216.25  94880
89.24.65.172  94879
73.57.155.246 94860
19.114.117.138  94816
69.30.22.55 94806
180.40.44.182 94789
96.65.132.14  94788
49.207.226.160  94783
65.56.65.35 94728
63.30.179.190 94721
134.124.174.120 94667
119.95.176.21 94663
13.46.95.192  94645
9.61.135.85 94645
94.54.98.98 94635
233.186.147.180 94615
246.46.206.86 94613
238.207.211.43  94603
137.31.9.250  94597
39.92.38.247  94516
215.160.81.159  94494
201.135.254.40  94426
74.209.111.251  94424

----------------------
--------Part C--------
----------------------
hive> select port, count(1) as c 
    > from (select * from rawblock join iptrace on (rawblock.id = iptrace.id and rawblock.status = 'Blocked')) blocks
    > group by port sort by c desc limit 5;

662 9601
982 9568
780 9546
812 9542
239 9535
